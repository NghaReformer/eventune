---
/**
 * Admin Layout
 * Luxury command center aesthetic - recording studio control room meets premium brand management
 *
 * Security: Role-based access, CSRF protection, audit logging
 */
import { getRoleDisplayName, getRoleBadgeClasses, hasPermission, getPermissionsForRole } from '../lib/auth/admin-session';
import { setCSRFToken, getFirstName, type SessionData } from '../lib/auth/session';

interface Props {
  title: string;
  activeNav?: 'dashboard' | 'orders' | 'customers' | 'analytics' | 'content' | 'settings' | 'referrals';
}

const { title, activeNav = 'dashboard' } = Astro.props;

// Session is set by middleware - if we reach here, user is authenticated
const session = Astro.locals.session as SessionData;

// Fallback redirect (shouldn't happen if middleware is working)
if (!session) {
  const currentPath = Astro.url.pathname;
  return Astro.redirect(`/auth/login?redirectTo=${encodeURIComponent(currentPath)}&error=admin_required`);
}

const { user, profile } = session;
const adminRole = profile?.admin_role as 'super_admin' | 'order_manager' | 'support' | null;

// Verify admin role - middleware should have already checked this, but double-check
if (!adminRole) {
  return Astro.redirect('/dashboard');
}

const permissions = getPermissionsForRole(adminRole);
const firstName = getFirstName(profile);
const roleDisplay = getRoleDisplayName(adminRole);
const roleBadgeClasses = getRoleBadgeClasses(adminRole);

// Set CSRF token for forms
const csrfToken = setCSRFToken(Astro.cookies);

// Make admin session available to child pages
Astro.locals.adminSession = { ...session, adminRole, permissions };
Astro.locals.csrfToken = csrfToken;

// Navigation items with permission checks
const navItems = [
  {
    href: '/admin',
    label: 'Dashboard',
    icon: 'dashboard',
    active: activeNav === 'dashboard',
    permission: 'dashboard:view',
  },
  {
    href: '/admin/orders',
    label: 'Orders',
    icon: 'orders',
    active: activeNav === 'orders',
    permission: 'orders:view',
    badge: null,
  },
  {
    href: '/admin/customers',
    label: 'Customers',
    icon: 'customers',
    active: activeNav === 'customers',
    permission: 'customers:view',
  },
  {
    href: '/admin/referrals',
    label: 'Referrals',
    icon: 'referrals',
    active: activeNav === 'referrals',
    permission: 'referrals:view',
  },
  {
    href: '/admin/analytics',
    label: 'Analytics',
    icon: 'analytics',
    active: activeNav === 'analytics',
    permission: 'analytics:view',
  },
  {
    href: '/admin/content',
    label: 'Content',
    icon: 'content',
    active: activeNav === 'content',
    permission: 'content:view',
  },
  {
    href: '/admin/settings',
    label: 'Settings',
    icon: 'settings',
    active: activeNav === 'settings',
    permission: 'settings:view',
  },
].filter(item => hasPermission(permissions, item.permission));
---

<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex, nofollow" />
  <title>{title} | Admin - Eventune Studios</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600;700&family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
</head>
<body class="admin-body">
  <!-- Subtle grid pattern overlay -->
  <div class="grid-overlay"></div>

  <!-- Mobile Header -->
  <header class="mobile-header">
    <div class="mobile-header-inner">
      <a href="/admin" class="mobile-logo">
        <div class="logo-icon">
          <span>E</span>
        </div>
        <div class="logo-text-wrap">
          <span class="logo-brand">Eventune</span>
          <span class="logo-sub">Admin</span>
        </div>
      </a>
      <div class="mobile-header-right">
        <span class={`role-badge ${roleBadgeClasses}`}>{roleDisplay}</span>
        <button
          id="mobile-menu-btn"
          class="mobile-menu-btn"
          aria-label="Toggle menu"
        >
          <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
      </div>
    </div>
  </header>

  <!-- Mobile Sidebar Overlay -->
  <div id="mobile-overlay" class="mobile-overlay"></div>

  <!-- Sidebar -->
  <aside id="sidebar" class="admin-sidebar">
    <!-- Logo Section -->
    <div class="sidebar-logo">
      <a href="/admin" class="logo-link">
        <div class="logo-icon-lg">
          <span>E</span>
        </div>
        <div class="logo-text-wrap">
          <span class="logo-brand">Eventune</span>
          <span class="logo-sub">Admin Console</span>
        </div>
      </a>
    </div>

    <!-- Admin Profile -->
    <div class="admin-profile">
      <div class="admin-profile-inner">
        <div class="admin-avatar">
          <span>{firstName.charAt(0).toUpperCase()}</span>
          <span class="online-indicator"></span>
        </div>
        <div class="admin-info">
          <p class="admin-name">{firstName}</p>
          <span class={`role-badge-sm ${roleBadgeClasses}`}>{roleDisplay}</span>
        </div>
      </div>
    </div>

    <!-- Navigation -->
    <nav class="sidebar-nav">
      <div class="nav-section-label">Navigation</div>
      <ul class="nav-list">
        {navItems.map((item) => (
          <li>
            <a
              href={item.href}
              class={`nav-item ${item.active ? 'active' : ''}`}
            >
              {item.icon === 'dashboard' && (
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 5a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM14 5a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1V5zM4 15a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H5a1 1 0 01-1-1v-4zM14 15a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z" />
                </svg>
              )}
              {item.icon === 'orders' && (
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                </svg>
              )}
              {item.icon === 'customers' && (
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                </svg>
              )}
              {item.icon === 'referrals' && (
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                </svg>
              )}
              {item.icon === 'analytics' && (
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                </svg>
              )}
              {item.icon === 'content' && (
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                </svg>
              )}
              {item.icon === 'settings' && (
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
              )}
              <span class="nav-label">{item.label}</span>
              {item.active && (
                <div class="nav-indicator"></div>
              )}
            </a>
          </li>
        ))}
      </ul>

      <!-- Divider -->
      <div class="nav-divider"></div>

      <!-- Quick Links -->
      <div class="nav-section-label">Quick Links</div>
      <ul class="nav-list-secondary">
        <li>
          <a href="/" target="_blank" class="nav-item-secondary">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
            </svg>
            <span>View Website</span>
          </a>
        </li>
        <li>
          <a href="/auth/logout" class="nav-item-secondary logout">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
            </svg>
            <span>Sign Out</span>
          </a>
        </li>
      </ul>
    </nav>

    <!-- VU Meter Decoration -->
    <div class="vu-meter-container">
      <div class="vu-meter">
        {[...Array(16)].map((_, i) => (
          <div
            class="vu-bar"
            style={`animation-delay: ${i * 0.08}s;`}
          ></div>
        ))}
      </div>
      <p class="vu-label">EVENTUNE ADMIN v1.0</p>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <div class="main-inner">
      <!-- Page Header -->
      <header class="page-header">
        <div class="page-header-content">
          <div class="page-header-left">
            <h1 class="page-title">{title}</h1>
            <div class="breadcrumb">
              <span class="breadcrumb-item">Admin Console</span>
              <span class="breadcrumb-sep">/</span>
              <span class="breadcrumb-current">{title}</span>
            </div>
          </div>

          <!-- Header Actions (Desktop) -->
          <div class="header-actions">
            <!-- Notifications -->
            <button class="header-btn">
              <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
              </svg>
              <span class="notification-dot"></span>
            </button>

            <!-- Profile Dropdown -->
            <div class="profile-dropdown">
              <div class="profile-info">
                <p class="profile-name">{firstName}</p>
                <p class="profile-email">{user.email}</p>
              </div>
              <div class="profile-avatar">
                <span>{firstName.charAt(0)}</span>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- Page Content -->
      <div class="page-content">
        <slot />
      </div>
    </div>
  </main>

  <style>
    :root {
      --admin-black: #0A0A0A;
      --admin-card: #111111;
      --admin-card-hover: #161616;
      --admin-cream: #F5F5F5;
      --gold: #D4AF37;
      --gold-dark: #B8962E;
      --gold-glow: rgba(212, 175, 55, 0.15);
    }

    * {
      box-sizing: border-box;
    }

    .admin-body {
      background-color: var(--admin-black);
      color: var(--admin-cream);
      font-family: 'Inter', sans-serif;
      min-height: 100vh;
      margin: 0;
      padding: 0;
    }

    /* Grid Overlay */
    .grid-overlay {
      position: fixed;
      inset: 0;
      pointer-events: none;
      opacity: 0.02;
      background-image: url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23D4AF37" fill-opacity="1"%3E%3Cpath d="M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');
    }

    /* Mobile Header */
    .mobile-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 50;
      background: rgba(17, 17, 17, 0.95);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(212, 175, 55, 0.1);
    }

    @media (min-width: 1024px) {
      .mobile-header {
        display: none;
      }
    }

    .mobile-header-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 1rem;
      height: 3.5rem;
    }

    .mobile-logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
    }

    .logo-icon {
      width: 2rem;
      height: 2rem;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logo-icon span {
      color: var(--admin-black);
      font-weight: 700;
      font-size: 0.875rem;
    }

    .logo-text-wrap {
      display: flex;
      flex-direction: column;
    }

    .logo-brand {
      font-family: 'Playfair Display', serif;
      font-size: 1.125rem;
      color: var(--gold);
      line-height: 1.1;
    }

    .logo-sub {
      font-size: 0.5625rem;
      color: rgba(212, 175, 55, 0.5);
      letter-spacing: 0.15em;
      text-transform: uppercase;
    }

    .mobile-header-right {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .mobile-menu-btn {
      padding: 0.5rem;
      background: none;
      border: none;
      color: rgba(245, 245, 245, 0.7);
      cursor: pointer;
      transition: color 0.2s;
    }

    .mobile-menu-btn:hover {
      color: var(--gold);
    }

    /* Role Badge */
    .role-badge {
      display: inline-flex;
      align-items: center;
      padding: 0.25rem 0.625rem;
      border-radius: 9999px;
      font-size: 0.625rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      border: 1px solid;
    }

    .role-badge-sm {
      display: inline-flex;
      align-items: center;
      padding: 0.125rem 0.5rem;
      border-radius: 9999px;
      font-size: 0.5625rem;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      border: 1px solid;
    }

    /* Mobile Overlay */
    .mobile-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(4px);
      z-index: 40;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .mobile-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    @media (min-width: 1024px) {
      .mobile-overlay {
        display: none;
      }
    }

    /* Sidebar */
    .admin-sidebar {
      position: fixed;
      left: 0;
      top: 0;
      bottom: 0;
      width: 16rem;
      background: linear-gradient(180deg, var(--admin-card) 0%, rgba(17, 17, 17, 0.98) 100%);
      border-right: 1px solid rgba(212, 175, 55, 0.08);
      z-index: 50;
      display: flex;
      flex-direction: column;
      transform: translateX(-100%);
      transition: transform 0.3s ease;
    }

    .admin-sidebar.open {
      transform: translateX(0);
    }

    @media (min-width: 1024px) {
      .admin-sidebar {
        transform: translateX(0);
      }
    }

    /* Sidebar Logo */
    .sidebar-logo {
      height: 4.5rem;
      display: flex;
      align-items: center;
      padding: 0 1.25rem;
      border-bottom: 1px solid rgba(212, 175, 55, 0.1);
    }

    .logo-link {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      text-decoration: none;
    }

    .logo-icon-lg {
      width: 2.25rem;
      height: 2.25rem;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px var(--gold-glow);
      transition: box-shadow 0.2s;
      flex-shrink: 0;
    }

    .logo-link:hover .logo-icon-lg {
      box-shadow: 0 4px 25px rgba(212, 175, 55, 0.4);
    }

    .logo-icon-lg span {
      color: var(--admin-black);
      font-weight: 700;
      font-size: 1rem;
    }

    /* Admin Profile */
    .admin-profile {
      padding: 1rem 1.25rem;
      border-bottom: 1px solid rgba(212, 175, 55, 0.05);
    }

    .admin-profile-inner {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .admin-avatar {
      position: relative;
      width: 2.5rem;
      height: 2.5rem;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(212, 175, 55, 0.15) 0%, rgba(212, 175, 55, 0.05) 100%);
      border: 1px solid rgba(212, 175, 55, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .admin-avatar > span:first-child {
      color: var(--gold);
      font-family: 'Playfair Display', serif;
      font-size: 1rem;
    }

    .online-indicator {
      position: absolute;
      bottom: -2px;
      right: -2px;
      width: 0.75rem;
      height: 0.75rem;
      background: #10b981;
      border-radius: 50%;
      border: 2px solid var(--admin-card);
    }

    .admin-info {
      flex: 1;
      min-width: 0;
    }

    .admin-name {
      font-weight: 500;
      color: var(--admin-cream);
      font-size: 0.875rem;
      margin: 0 0 0.25rem 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Navigation */
    .sidebar-nav {
      flex: 1;
      padding: 1.25rem 0.75rem;
      overflow-y: auto;
    }

    .nav-section-label {
      padding: 0 1rem;
      margin-bottom: 0.5rem;
      font-size: 0.625rem;
      font-weight: 600;
      color: rgba(245, 245, 245, 0.3);
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .nav-list {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.625rem 1rem;
      margin: 0 0.25rem;
      border-radius: 0.5rem;
      text-decoration: none;
      color: rgba(245, 245, 245, 0.5);
      font-size: 0.875rem;
      transition: all 0.2s ease;
      border-left: 2px solid transparent;
    }

    .nav-item:hover {
      background: rgba(212, 175, 55, 0.05);
      color: var(--admin-cream);
    }

    .nav-item.active {
      background: rgba(212, 175, 55, 0.1);
      color: var(--gold);
      border-left-color: var(--gold);
    }

    .nav-label {
      font-weight: 500;
    }

    .nav-indicator {
      margin-left: auto;
      width: 0.375rem;
      height: 0.375rem;
      border-radius: 50%;
      background: var(--gold);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .nav-divider {
      margin: 1.25rem 1rem;
      border-top: 1px solid rgba(212, 175, 55, 0.1);
    }

    .nav-list-secondary {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .nav-item-secondary {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      margin: 0 0.25rem;
      border-radius: 0.5rem;
      text-decoration: none;
      color: rgba(245, 245, 245, 0.4);
      font-size: 0.8125rem;
      transition: all 0.2s ease;
    }

    .nav-item-secondary:hover {
      background: rgba(212, 175, 55, 0.05);
      color: var(--gold);
    }

    .nav-item-secondary.logout:hover {
      background: rgba(248, 113, 113, 0.1);
      color: #f87171;
    }

    /* VU Meter */
    .vu-meter-container {
      padding: 1rem 1.5rem;
      border-top: 1px solid rgba(212, 175, 55, 0.05);
    }

    .vu-meter {
      display: flex;
      align-items: flex-end;
      justify-content: center;
      gap: 0.1875rem;
      height: 2rem;
    }

    .vu-bar {
      width: 0.25rem;
      height: 0.5rem;
      background: linear-gradient(to top, var(--gold) 0%, rgba(212, 175, 55, 0.3) 100%);
      border-radius: 2px;
      animation: vu-meter 1.2s ease-in-out infinite;
      transform-origin: bottom;
      opacity: 0.4;
    }

    @keyframes vu-meter {
      0%, 100% { height: 0.5rem; opacity: 0.3; }
      50% { height: 1.5rem; opacity: 0.6; }
    }

    .vu-label {
      text-align: center;
      font-size: 0.625rem;
      color: rgba(245, 245, 245, 0.2);
      margin-top: 0.5rem;
      font-family: 'JetBrains Mono', monospace;
    }

    /* Main Content */
    .main-content {
      min-height: 100vh;
      padding-left: 0;
    }

    @media (min-width: 1024px) {
      .main-content {
        padding-left: 16rem;
      }
    }

    .main-inner {
      padding-top: 3.5rem;
    }

    @media (min-width: 1024px) {
      .main-inner {
        padding-top: 0;
      }
    }

    /* Page Header */
    .page-header {
      padding: 1.25rem;
      border-bottom: 1px solid rgba(212, 175, 55, 0.08);
      background: linear-gradient(90deg, rgba(17, 17, 17, 0.8) 0%, transparent 100%);
    }

    @media (min-width: 640px) {
      .page-header {
        padding: 1.5rem;
      }
    }

    @media (min-width: 1024px) {
      .page-header {
        padding: 1.5rem 2rem;
      }
    }

    .page-header-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }

    .page-header-left {
      min-width: 0;
    }

    .page-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.375rem;
      font-weight: 600;
      color: var(--admin-cream);
      margin: 0;
    }

    @media (min-width: 640px) {
      .page-title {
        font-size: 1.5rem;
      }
    }

    @media (min-width: 1024px) {
      .page-title {
        font-size: 1.75rem;
      }
    }

    .breadcrumb {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-top: 0.25rem;
      font-size: 0.75rem;
    }

    .breadcrumb-item {
      color: rgba(245, 245, 245, 0.4);
    }

    .breadcrumb-sep {
      color: rgba(212, 175, 55, 0.3);
    }

    .breadcrumb-current {
      color: rgba(212, 175, 55, 0.7);
    }

    /* Header Actions */
    .header-actions {
      display: none;
      align-items: center;
      gap: 1rem;
    }

    @media (min-width: 1024px) {
      .header-actions {
        display: flex;
      }
    }

    .header-btn {
      position: relative;
      padding: 0.5rem;
      background: none;
      border: none;
      border-radius: 0.5rem;
      color: rgba(245, 245, 245, 0.5);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .header-btn:hover {
      background: rgba(212, 175, 55, 0.1);
      color: var(--gold);
    }

    .notification-dot {
      position: absolute;
      top: 0.25rem;
      right: 0.25rem;
      width: 0.5rem;
      height: 0.5rem;
      background: #ef4444;
      border-radius: 50%;
      border: 2px solid var(--admin-card);
    }

    .profile-dropdown {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding-left: 1rem;
      border-left: 1px solid rgba(212, 175, 55, 0.1);
    }

    .profile-info {
      text-align: right;
    }

    .profile-name {
      font-size: 0.8125rem;
      font-weight: 500;
      color: var(--admin-cream);
      margin: 0;
    }

    .profile-email {
      font-size: 0.6875rem;
      color: rgba(245, 245, 245, 0.5);
      margin: 0;
    }

    .profile-avatar {
      width: 2rem;
      height: 2rem;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(212, 175, 55, 0.2) 0%, rgba(212, 175, 55, 0.1) 100%);
      border: 1px solid rgba(212, 175, 55, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .profile-avatar span {
      color: var(--gold);
      font-family: 'Playfair Display', serif;
      font-size: 0.875rem;
    }

    /* Page Content */
    .page-content {
      padding: 1.25rem;
    }

    @media (min-width: 640px) {
      .page-content {
        padding: 1.5rem;
      }
    }

    @media (min-width: 1024px) {
      .page-content {
        padding: 2rem;
      }
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: var(--admin-black);
    }

    ::-webkit-scrollbar-thumb {
      background: rgba(212, 175, 55, 0.3);
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--gold);
    }
  </style>

  <script>
    // Mobile menu toggle
    const menuBtn = document.getElementById('mobile-menu-btn');
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('mobile-overlay');

    function toggleMenu() {
      sidebar?.classList.toggle('open');
      if (sidebar?.classList.contains('open')) {
        overlay?.classList.add('active');
      } else {
        overlay?.classList.remove('active');
      }
    }

    menuBtn?.addEventListener('click', toggleMenu);
    overlay?.addEventListener('click', toggleMenu);
  </script>
</body>
</html>
